{"ast":null,"code":"import * as i0 from \"@angular/core\";\nimport * as i1 from \"../services/timebox.service\";\nimport * as i2 from \"@angular/common\";\n\nfunction AprComponent_span_2_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"span\", 12);\n    i0.ɵɵtext(1);\n    i0.ɵɵelement(2, \"br\");\n    i0.ɵɵtext(3);\n    i0.ɵɵpipe(4, \"titlecase\");\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    const ctx_r0 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate3(\" \", ctx_r0.weekDay, \", \", ctx_r0.date, \", \", ctx_r0.yearEaster, \" \\u0433\\u043E\\u0434\\u0430.\");\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate1(\" \\u0421\\u0435\\u0434\\u043C\\u0438\\u0446\\u0430 \", i0.ɵɵpipeBind1(4, 4, ctx_r0.currentWeek), \" \");\n  }\n}\n\nfunction AprComponent_ng_template_3_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"span\", 13);\n    i0.ɵɵelementStart(1, \"b\");\n    i0.ɵɵtext(2);\n    i0.ɵɵpipe(3, \"titlecase\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n    i0.ɵɵtext(4);\n    i0.ɵɵelement(5, \"br\");\n    i0.ɵɵtext(6);\n  }\n\n  if (rf & 2) {\n    const ctx_r2 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate1(\"\", i0.ɵɵpipeBind1(3, 4, ctx_r2.weekDay), \",\");\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate2(\" \", ctx_r2.date, \", \", ctx_r2.yearEaster, \" \\u0433\\u043E\\u0434\\u0430.\");\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate1(\" \\u0421\\u0435\\u0434\\u043C\\u0438\\u0446\\u0430 \", ctx_r2.currentWeek, \" \");\n  }\n}\n\nexport let AprComponent = /*#__PURE__*/(() => {\n  class AprComponent {\n    constructor(timeBox) {\n      this.timeBox = timeBox;\n      /**\n       * Апракос в формате JSON.\n       * Данный json не входит в состав программы, составляется и корретируется в другом проекте. Данный JSON файл является оригинальным поддерживаемым документом.\n       */\n\n      this.url = \"https://cdn.jsdelivr.net/gh/a374ru/aprakos-json@master/aprakos.json\";\n      /**\n       * Название текущего дня\n       */\n\n      this.weekDay = this.timeBox.formatsEaster.dayName;\n      /**\n       * Седмица по Пасхе\n       */\n\n      this.weekFromEaster = this.timeBox.formatsEaster.currentWeek;\n      /**\n       * Текущая седмица по Уставу.\n       * Может быть седмицей от Пасхи до Пятидесятницы.\n       * Может быть седмицей от Пятидесятницы до Пасхи.\n       * Корректировка номера текущей седмицы. Зависит от части года (По Пасхе или по Пятьдесятнице)\n       */\n\n      this.currentWeek = this.weekFromEaster < 8 ? ` по Пасхе ${this.weekFromEaster}` : ` по Пятьдесятнице: ${this.weekFromEaster - 7}`;\n\n      try {\n        this.date = this.timeBox.theMoment.getDate() + \" \" + this.timeBox.formatsEaster.currentMonth;\n        this.yearEaster = this.timeBox.theMoment.getFullYear() + \"\"; // Получение aprakos.json с сервера.\n\n        fetch(this.url).then(loadedJson => loadedJson.text()).then(loadedJsonText => this.currentZachalo(JSON.parse(loadedJsonText))).catch(() => alert(\"Неудачная загрузка. Обновите страницу…\"));\n      } finally {\n        // this.apstl = \"Загрузка...\"\n        this.evngl = \"Загрузка...\";\n      }\n    }\n    /**\n     * Запускает загрузку `json` с другого сервера.\n     * Вызывает функцию `currentZachalo()`.\n     */\n\n\n    ngOnInit() {}\n    /**\n     * Функция вычисляет текущее зачало из файла aprakos.json и выполняет поиск по регулярному выражению номера стиха и первой буквы зачал Апостола и Евангелия для выделения киноварью в шаблоне HTML.\n     */\n\n\n    currentZachalo(json) {\n      this.stupka = this.timeBox.formatsEaster.vozStupka;\n      console.log(this.stupka);\n\n      for (const key in json) {\n        const curApr = \"\" + (this.timeBox.formatsEaster.currentWeek - this.stupka) + this.timeBox.formatsEaster.dayNum;\n\n        if (json[key].aprakos == curApr) {\n          this.zapstl = json[key].zapstl;\n          this.apstl = json[key].apstl;\n          this.zevngl = json[key].zevngl;\n          this.evngl = json[key].evngl; // Регулярное выражение для поиска нумерации стихов и БУКВИЦЫ\n\n          let regx = /\\(За\\?\\s\\S*\\)\\s(\\S|Ё|)?#?:?\\$?/;\n          let rng = json[key].apstl.match(regx);\n          this.apstl = json[key].apstl.slice(rng[0].length);\n          this.buckvicaApstl = rng[0];\n          let rng2 = json[key].evngl.match(regx);\n          this.evngl = json[key].evngl.slice(rng2[0].length);\n          this.buckvicaEvngl = rng2[0];\n        }\n      }\n    }\n\n  }\n\n  AprComponent.ɵfac = function AprComponent_Factory(t) {\n    return new (t || AprComponent)(i0.ɵɵdirectiveInject(i1.TimeboxService));\n  };\n\n  AprComponent.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n    type: AprComponent,\n    selectors: [[\"app-apr\"]],\n    decls: 25,\n    vars: 8,\n    consts: [[1, \"container\"], [\"id\", \"zachala\", 1, \"h5\", \"fontics\", 2, \"padding\", \"0px\", \"color\", \"slategray\"], [\"style\", \"color: #e34234;\", 4, \"ngIf\", \"ngIfElse\"], [\"elseBlock\", \"\"], [1, \"hr-1\"], [1, \"row\", \"h4\"], [\"id\", \"apstl\", 1, \"col-md\", \"csl\"], [\"id\", \"zapstl\", 1, \"fontics\"], [1, \"black\"], [1, \"red\"], [\"id\", \"evngl\", 1, \"col\", \"csl\"], [\"id\", \"zevngl\", 1, \"fontics\"], [2, \"color\", \"#e34234\"], [2, \"color\", \"blueviolet\"]],\n    template: function AprComponent_Template(rf, ctx) {\n      if (rf & 1) {\n        i0.ɵɵelementStart(0, \"section\", 0);\n        i0.ɵɵelementStart(1, \"p\", 1);\n        i0.ɵɵtemplate(2, AprComponent_span_2_Template, 5, 6, \"span\", 2);\n        i0.ɵɵtemplate(3, AprComponent_ng_template_3_Template, 7, 6, \"ng-template\", null, 3, i0.ɵɵtemplateRefExtractor);\n        i0.ɵɵelementEnd();\n        i0.ɵɵelement(5, \"hr\", 4);\n        i0.ɵɵelementStart(6, \"div\", 5);\n        i0.ɵɵelementStart(7, \"div\", 6);\n        i0.ɵɵelementStart(8, \"p\", 7);\n        i0.ɵɵelementStart(9, \"span\", 8);\n        i0.ɵɵtext(10, \"\\u0410\\u043F\\u043E\\u0441\\u0442\\u043E\\u043B\\u044A: \");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelement(11, \"br\");\n        i0.ɵɵtext(12);\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(13, \"span\", 9);\n        i0.ɵɵtext(14);\n        i0.ɵɵelementEnd();\n        i0.ɵɵtext(15);\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(16, \"div\", 10);\n        i0.ɵɵelementStart(17, \"p\", 11);\n        i0.ɵɵelementStart(18, \"span\", 8);\n        i0.ɵɵtext(19, \"\\u0415\\u0432\\u0430\\u043D\\u0433\\u0435\\u043B\\u0438\\u0435: \");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelement(20, \"br\");\n        i0.ɵɵtext(21);\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(22, \"span\", 9);\n        i0.ɵɵtext(23);\n        i0.ɵɵelementEnd();\n        i0.ɵɵtext(24);\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n      }\n\n      if (rf & 2) {\n        const _r1 = i0.ɵɵreference(4);\n\n        i0.ɵɵadvance(2);\n        i0.ɵɵproperty(\"ngIf\", ctx.weekDay == \"\\u0412\\u041E\\u0421\\u041A\\u0420\\u0415\\u0421\\u0415\\u041D\\u042C\\u0415\")(\"ngIfElse\", _r1);\n        i0.ɵɵadvance(10);\n        i0.ɵɵtextInterpolate1(\"\", ctx.zapstl, \" \");\n        i0.ɵɵadvance(2);\n        i0.ɵɵtextInterpolate(ctx.buckvicaApstl);\n        i0.ɵɵadvance(1);\n        i0.ɵɵtextInterpolate1(\"\", ctx.apstl, \" \");\n        i0.ɵɵadvance(6);\n        i0.ɵɵtextInterpolate1(\"\", ctx.zevngl, \" \");\n        i0.ɵɵadvance(2);\n        i0.ɵɵtextInterpolate(ctx.buckvicaEvngl);\n        i0.ɵɵadvance(1);\n        i0.ɵɵtextInterpolate1(\"\", ctx.evngl, \" \");\n      }\n    },\n    directives: [i2.NgIf],\n    pipes: [i2.TitleCasePipe],\n    styles: [\"p[_ngcontent-%COMP%]{padding:7px 2px 4% 12px}.black[_ngcontent-%COMP%]{color:#666}#zapstl[_ngcontent-%COMP%], #zevngl[_ngcontent-%COMP%]{color:#e34234;font-size:100%}#apstl[_ngcontent-%COMP%], #evngl[_ngcontent-%COMP%]{padding:7px 22px 4% 12px}\"]\n  });\n  return AprComponent;\n})();","map":null,"metadata":{},"sourceType":"module"}